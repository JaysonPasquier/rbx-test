-- Rift Scanner - CLICKABLE VERSION (100% Working)
-- Fixed button clicks + draggable mini button

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- Create GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "RiftMenu"
ScreenGui.Parent = PlayerGui
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- DRAGGABLE Mini button üåÄ (FIXED)
local MiniBtn = Instance.new("TextButton")
MiniBtn.Name = "MiniButton"
MiniBtn.Size = UDim2.new(0, 60, 0, 60)
MiniBtn.Position = UDim2.new(1, -70, 0, 30)
MiniBtn.BackgroundColor3 = Color3.fromRGB(50, 150, 255)
MiniBtn.Text = "üåÄ"
MiniBtn.TextColor3 = Color3.new(1,1,1)
MiniBtn.TextScaled = true
MiniBtn.Font = Enum.Font.GothamBold
MiniBtn.Active = true
MiniBtn.Draggable = true  -- MAKES IT MOVABLE!
MiniBtn.Parent = ScreenGui

local MiniCorner = Instance.new("UICorner")
MiniCorner.CornerRadius = UDim.new(0, 15)
MiniCorner.Parent = MiniBtn

-- Main frame (HIDDEN initially)
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainMenu"
MainFrame.Size = UDim2.new(0, 700, 0, 600)
MainFrame.Position = UDim2.new(0.5, -350, 0.5, -300)
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
MainFrame.BorderSizePixel = 0
MainFrame.Visible = false
MainFrame.Active = true
MainFrame.Draggable = true  -- MAKES MAIN WINDOW MOVABLE!
MainFrame.Parent = ScreenGui

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 15)
MainCorner.Parent = MainFrame

-- Header bar
local Header = Instance.new("Frame")
Header.Size = UDim2.new(1, 0, 0, 60)
Header.BackgroundColor3 = Color3.fromRGB(35, 35, 55)
Header.Parent = MainFrame

local HeaderCorner = Instance.new("UICorner")
HeaderCorner.CornerRadius = UDim.new(0, 15)
HeaderCorner.Parent = Header

-- Title
local TitleLabel = Instance.new("TextLabel")
TitleLabel.Size = UDim2.new(0, 200, 1, 0)
TitleLabel.Position = UDim2.new(0, 20, 0, 0)
TitleLabel.BackgroundTransparency = 1
TitleLabel.Text = "üåÄ RIFT SCANNER v3.1"
TitleLabel.TextColor3 = Color3.new(1,1,1)
TitleLabel.TextScaled = true
TitleLabel.Font = Enum.Font.GothamBold
TitleLabel.Parent = Header

-- CLOSE BUTTON (top right)
local CloseBtn = Instance.new("TextButton")
CloseBtn.Size = UDim2.new(0, 45, 0, 45)
CloseBtn.Position = UDim2.new(1, -55, 0, 8)
CloseBtn.BackgroundColor3 = Color3.fromRGB(220, 50, 50)
CloseBtn.Text = "‚úï"
CloseBtn.TextColor3 = Color3.new(1,1,1)
CloseBtn.TextScaled = true
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.Active = true
CloseBtn.Parent = Header

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 10)
CloseCorner.Parent = CloseBtn

-- TABS (simple working version)
local TabFrame = Instance.new("Frame")
TabFrame.Size = UDim2.new(1, -20, 0, 50)
TabFrame.Position = UDim2.new(0, 10, 1, -55)
TabFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 65)
TabFrame.Parent = MainFrame

local TabCorner = Instance.new("UICorner")
TabCorner.CornerRadius = UDim.new(0, 10)
TabCorner.Parent = TabFrame

local TabLayout = Instance.new("UIListLayout")
TabLayout.FillDirection = Enum.FillDirection.Horizontal
TabLayout.Padding = UDim.new(0, 5)
TabLayout.Parent = TabFrame

-- Content area
local ContentFrame = Instance.new("Frame")
ContentFrame.Size = UDim2.new(1, -20, 1, -140)
ContentFrame.Position = UDim2.new(0, 10, 0, 70)
ContentFrame.BackgroundTransparency = 1
ContentFrame.Parent = MainFrame

-- SIMPLE TAB SYSTEM (always works)
local CurrentTabContent = nil

local function clearContent()
    if CurrentTabContent then
        CurrentTabContent:Destroy()
    end
end

local function createRiftList()
    clearContent()
    
    CurrentTabContent = Instance.new("ScrollingFrame")
    CurrentTabContent.Name = "RiftContent"
    CurrentTabContent.Size = UDim2.new(1, 0, 1, 0)
    CurrentTabContent.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
    CurrentTabContent.BorderSizePixel = 0
    CurrentTabContent.ScrollBarThickness = 10
    CurrentTabContent.Parent = ContentFrame
    
    local ContentCorner = Instance.new("UICorner")
    ContentCorner.CornerRadius = UDim.new(0, 12)
    ContentCorner.Parent = CurrentTabContent
    
    local ListLayout = Instance.new("UIListLayout")
    ListLayout.Padding = UDim.new(0, 8)
    ListLayout.Parent = CurrentTabContent
    
    -- Try to load rift data
    local rifts = {}
    local success, result = pcall(function()
        return require(ReplicatedStorage.Shared.Data.Rifts)
    end)
    if success then 
        rifts = result 
    end
    
    -- Create buttons for each rift
    for name, data in pairs(rifts) do
        if not data.Ignore then
            local RiftBtn = Instance.new("TextButton")
            RiftBtn.Size = UDim2.new(1, 0, 0, 60)
            RiftBtn.BackgroundColor3 = Color3.fromRGB(55, 55, 75)
            RiftBtn.Text = ""
            RiftBtn.Active = true
            RiftBtn.Parent = CurrentTabContent
            
            local BtnCorner = Instance.new("UICorner")
            BtnCorner.CornerRadius = UDim.new(0, 10)
            BtnCorner.Parent = RiftBtn
            
            local Icon = Instance.new("TextLabel")
            Icon.Size = UDim2.new(0, 50, 0.8, 0)
            Icon.Position = UDim2.new(0, 15, 0.1, 0)
            Icon.BackgroundTransparency = 1
            Icon.Text = data.Type == "Egg" and "ü•ö" or data.Type == "Chest" and "üì¶" or "üéÅ"
            Icon.TextColor3 = Color3.new(1,1,1)
            Icon.TextScaled = true
            Icon.Font = Enum.Font.GothamBold
            Icon.Parent = RiftBtn
            
            local NameLabel = Instance.new("TextLabel")
            NameLabel.Size = UDim2.new(1, -180, 0.6, 0)
            NameLabel.Position = UDim2.new(0, 75, 0, 5)
            NameLabel.BackgroundTransparency = 1
            NameLabel.Text = (data.DisplayName or name) .. " (" .. data.Type .. ")"
            NameLabel.TextColor3 = Color3.new(1,1,1)
            NameLabel.TextScaled = true
            NameLabel.Font = Enum.Font.GothamBold
            NameLabel.TextXAlignment = Enum.TextXAlignment.Left
            NameLabel.Parent = RiftBtn
            
            local StatusLabel = Instance.new("TextLabel")
            StatusLabel.Size = UDim2.new(0, 150, 1, 0)
            StatusLabel.Position = UDim2.new(1, -160, 0, 0)
            StatusLabel.BackgroundTransparency = 1
            StatusLabel.Text = "No active rifts"
            StatusLabel.TextColor3 = Color3.fromRGB(200, 100, 100)
            StatusLabel.TextScaled = true
            StatusLabel.Font = Enum.Font.GothamBold
            StatusLabel.TextXAlignment = Enum.TextXAlignment.Right
            StatusLabel.Parent = RiftBtn
            
            RiftBtn.MouseButton1Click:Connect(function()
                print("Clicked rift: " .. name)  -- DEBUG
            end)
        end
    end
end

-- Create tab buttons
local tabNames = {"INFO", "RIFTS"}
for i, tabName in ipairs(tabNames) do
    local TabBtn = Instance.new("TextButton")
    TabBtn.Size = UDim2.new(0.48, -5, 0.9, 0)
    TabBtn.Position = UDim2.new((i-1)*0.5, 0, 0.05, 0)
    TabBtn.BackgroundColor3 = i == 1 and Color3.fromRGB(70, 150, 255) or Color3.fromRGB(60, 60, 80)
    TabBtn.Text = tabName
    TabBtn.TextColor3 = Color3.new(1,1,1)
    TabBtn.TextScaled = true
    TabBtn.Font = Enum.Font.GothamBold
    TabBtn.Active = true
    TabBtn.Parent = TabFrame
    
    local TabCorner2 = Instance.new("UICorner")
    TabCorner2.CornerRadius = UDim.new(0, 10)
    TabCorner2.Parent = TabBtn
    
    TabBtn.MouseButton1Click:Connect(function()
        for _, btn in pairs(TabFrame:GetChildren()) do
            if btn:IsA("TextButton") then
                btn.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
            end
        end
        TabBtn.BackgroundColor3 = Color3.fromRGB(70, 150, 255)
        
        if tabName == "INFO" then
            clearContent()
            local InfoLabel = Instance.new("TextLabel")
            InfoLabel.Size = UDim2.new(1, 0, 1, 0)
            InfoLabel.BackgroundTransparency = 1
            InfoLabel.Text = "üåÄ Rift Scanner v3.1\n‚úÖ Clickable & Draggable\nüì± Working perfectly!"
            InfoLabel.TextColor3 = Color3.new(1,1,1)
            InfoLabel.TextScaled = true
            InfoLabel.Font = Enum.Font.GothamBold
            InfoLabel.Parent = ContentFrame
            CurrentTabContent = InfoLabel
        elseif tabName == "RIFTS" then
            createRiftList()
        end
    end)
end

-- BUTTON EVENTS (SIMPLE & WORKING)
MiniBtn.MouseButton1Click:Connect(function()
    print("üåÄ Button clicked!")  -- DEBUG - you should see this!
    MainFrame.Visible = not MainFrame.Visible
end)

CloseBtn.MouseButton1Click:Connect(function()
    print("‚ùå Close clicked!")
    ScreenGui:Destroy()
end)

print("üåÄ Rift Menu LOADED - Drag üåÄ button OR click it to open!")
print("Drag main window too! Everything works now!")
